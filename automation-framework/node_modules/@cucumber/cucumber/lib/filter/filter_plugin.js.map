{"version":3,"file":"filter_plugin.js","sourceRoot":"","sources":["../../src/filter/filter_plugin.ts"],"names":[],"mappings":";;;;;;AAEA,qEAA2C;AAC3C,4CAA6C;AAEhC,QAAA,YAAY,GAAwC;IAC/D,IAAI,EAAE,QAAQ;IACd,WAAW,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,EAAE;QAC1D,IAAI,qBAAqB,GAAa,EAAE,CAAA;QACxC,EAAE,CAAC,eAAe,EAAE,CAAC,KAAK,EAAE,EAAE;YAC5B,qBAAqB,GAAG,KAAK,CAAC,qBAAqB,CAAA;QACrD,CAAC,CAAC,CAAA;QAEF,EAAE,CAAC,gBAAgB,EAAE,KAAK,EAAE,UAAU,EAAE,EAAE;YACxC,MAAM,YAAY,GAAG,IAAI,uBAAY,CAAC;gBACpC,GAAG,EAAE,WAAW,CAAC,GAAG;gBACpB,YAAY,EAAE,qBAAqB;gBACnC,KAAK,EAAE,OAAO,CAAC,KAAK;gBACpB,aAAa,EAAE,OAAO,CAAC,aAAa;aACrC,CAAC,CAAA;YAEF,OAAO,UAAU,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAA;QACpE,CAAC,CAAC,CAAA;QAEF,EAAE,CAAC,eAAe,EAAE,KAAK,EAAE,gBAAgB,EAAE,EAAE;YAC7C,MAAM,cAAc,GAAG,CAAC,GAAG,gBAAgB,CAAC,CAAA;YAC5C,IAAA,sBAAY,EAAC,cAAc,EAAE,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;YACnD,OAAO,cAAc,CAAA;QACvB,CAAC,CAAC,CAAA;IACJ,CAAC;CACF,CAAA","sourcesContent":["import { InternalPlugin } from '../plugin'\nimport { ISourcesCoordinates } from '../api'\nimport PickleFilter from '../pickle_filter'\nimport { orderPickles } from '../cli/helpers'\n\nexport const filterPlugin: InternalPlugin<ISourcesCoordinates> = {\n  type: 'plugin',\n  coordinator: async ({ on, options, logger, environment }) => {\n    let unexpandedSourcePaths: string[] = []\n    on('paths:resolve', (paths) => {\n      unexpandedSourcePaths = paths.unexpandedSourcePaths\n    })\n\n    on('pickles:filter', async (allPickles) => {\n      const pickleFilter = new PickleFilter({\n        cwd: environment.cwd,\n        featurePaths: unexpandedSourcePaths,\n        names: options.names,\n        tagExpression: options.tagExpression,\n      })\n\n      return allPickles.filter((pickle) => pickleFilter.matches(pickle))\n    })\n\n    on('pickles:order', async (unorderedPickles) => {\n      const orderedPickles = [...unorderedPickles]\n      orderPickles(orderedPickles, options.order, logger)\n      return orderedPickles\n    })\n  },\n}\n"]}